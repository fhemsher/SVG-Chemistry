<!DOCTYPE html>
<meta charset="utf-8">

<head>
    <link rel="stylesheet" type="text/css" href="./../dist/molecules.css">
    <script src="./../dist/molecules.min.js"></script>
    <script src="./../lib/d3.min.js"></script>


<meta http-equiv="content-type" content="text/html; charset=UTF-8">

</head>



<body onload=sendSize() style=background:white;padding:0px;font-family:arial >

 <div id=containerDiv style='background:white;'>
<center><b>Preview SVG Molecules</b>



<br>
Chemical Name:<input type="text" id=chemicalNameValue  style=width:240px />
 <br>Examples:<select id="chemicalNameSelect" onchange=chemicalNameSelected()>
                                <option >Chemical Name Examples (IUPAC)</option>
                                <option value="2,4,6-trinitrotoluene">2,4,6-trinitrotoluene</option>
                                <option value="2-amino-propanoic-acid">2-amino-propanoic acid</option>
                                <option value="N,N-diethylhexanamide">N,N-diethylhexanamide</option>
                                <option value="N-ethyl-N-propyl-3-methylbutanamide">N-ethyl-N-propyl-3-methylbutanamide</option>
                                <option value="2-bromo-3-ethoxy-4-methylhexane">2-bromo-3-ethoxy-4-methylhexane</option>
                                <option value="1-iodo-2-chloroethyne">1-iodo-2-chloroethyne</option>
                                <option value="2-bromo-2,3-difluoropent-4-ynoic-acid">2-bromo-2,3-difluoropent-4-ynoic acid</option>
                                <option value="5-methyloct-3-yn-2,6-dione">5-methyloct-3-yn-2,6-dione</option>
                                <option value="3-methyl-3-iodobutanal">3-methyl-3-iodobutanal</option>
                                <option value="3-iodo-3-methylhexan-1,4-diamine">3-iodo-3-methylhexan-1,4-diamine</option>
                                <option value="3,4-dichloro-4-ethyl-5-methylheptane">3,4-dichloro-4-ethyl-5-methylheptane</option>


 </select>


 <p></p>
    <div><a href="https://opsin.ch.cam.ac.uk/" target="_blank">Search chemical name for its SMILES Notation</a></div>
<p></p>

SMILES:<input placeholder="Paste SMILES Notation here..." type="text" id=smilesValue  style=width:440px />
<div style=overflow:hidden;width:1px;height:1px>
<svg>
<defs>
<radialGradient id="atomH" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#00FF48"/>
<stop offset="100%" style="stop-color:#11BE42"/>
</radialGradient>
<radialGradient id="atomN" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#0000AA"/>
<stop offset="100%" style="stop-color:#000077"/>
</radialGradient>
<radialGradient id="atomHe" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#37A1E7"/>
<stop offset="100%" style="stop-color:#378BC7"/>
</radialGradient>
<radialGradient id="atomB" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#CDB966"/>
<stop offset="100%" style="stop-color:#BCAB5E"/>
</radialGradient>
<radialGradient id="atomC" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#242729"/>
<stop offset="100%" style="stop-color:#24282A"/>
</radialGradient>
<radialGradient id="atomO" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#EB3941"/>
<stop offset="100%" style="stop-color:#C12D36"/>
</radialGradient>
<radialGradient id="atomF" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#AC49E3"/>
<stop offset="100%" style="stop-color:#9D42D0"/>
</radialGradient>
<radialGradient id="atomNa" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#AB5CF2"/>
<stop offset="100%" style="stop-color:#A66CE0"/>
</radialGradient>
<radialGradient id="atomSi" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#959595"/>
<stop offset="100%" style="stop-color:#7C7C7C"/>
</radialGradient>
<radialGradient id="atomP" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#00AE78"/>
<stop offset="100%" style="stop-color:#009D6D"/>
</radialGradient>
<radialGradient id="atomS" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#FFE382"/>
<stop offset="100%" style="stop-color:#F3D379"/>
</radialGradient>
<radialGradient id="atomCl" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#00BB00"/>
<stop offset="100%" style="stop-color:#00A200"/>
</radialGradient>
<radialGradient id="atomAs" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#827340"/>
<stop offset="100%" style="stop-color:#726437"/>
</radialGradient>
<radialGradient id="atomSe" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#CA0A14"/>
<stop offset="100%" style="stop-color:#A2030C"/>
</radialGradient>
<radialGradient id="atomBr" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#F08F27"/>
<stop offset="100%" style="stop-color:#DB8226"/>
</radialGradient>
<radialGradient id="atomI" gradientUnits="objectBoundingBox"
fx="30%" fy="30%">
<stop offset="0%"   style="stop-color:#FFFFFF"/>
<stop offset="40%"  style="stop-color:#7C90C7"/>
<stop offset="100%" style="stop-color:#60719E"/>
</radialGradient>
</defs></svg>


</div>

<p></p><button onclick=loadSmiles()>Load SMILES</button>
<table>
    <tr><td valign=center>
     <svg width=15 height=15 overflow="visible"><circle r="6" class="atom-H"></svg>H
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-He" ></svg>He
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-B" ></svg>B
    <br><svg width=15 height=15  overflow="visible"><circle r="10"  class="atom-C"  ></svg>C
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-N" ></svg>N
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-O" ></svg>O
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-F" ></svg>F
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-Na" ></svg>Na
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-Si" ></svg>Si
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-P" ></svg>P
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-S" ></svg>S
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-Cl" ></svg>Cl
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-As" ></svg>As
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-Se" ></svg>Se
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-Br" ></svg>Br
    <br><svg width=15 height=15  overflow="visible"><circle r="10" class="atom-I" ></svg>I
    </td>
 <td valign=top><div id=svgDiv style='width:400px;height:400px;border:1px solid black'></div></td>
    </tr>
</table>



  <div style='color:blue' id="molecularFormulaDiv"></div>


 <button id=addMoleculeButton disabled onClick=parent.addMolecule() >Add Molecule</button>
</center>
</div>
 <button title="Close molecule preview" onclick=parent.closeMoleculePreview() style='position:absolute;top:10px;left:90%'>X</button>

</body>

<script>



 //---button----
 var PlotWidth=400
 var PlotHeight=400
function loadSmiles()
{

 addMoleculeButton.disabled=false
  var input=smilesValue.value
       if(input.length>200)
        {
            PlotWidth=800
            PlotHeight=800
            svgDiv.style.width=PlotWidth+"px"
            svgDiv.style.height=PlotHeight+"px"

            sendSize()

        }
        mainPanel.attr("viewBox", "0 0 " + PlotWidth + " " +  PlotHeight + "")
      parent.ChemicalName=chemicalNameValue.value
        forceProperties.size=[PlotWidth, PlotHeight],
         force.size(forceProperties.size)

  var molecule = Molecules.load.smiles(input)

    if (typeof molecule === 'object') { update(molecule); }

}


//
// molecules.js --> d3.js
//
function convertMolecule(molecule) {

    var atoms = Object.keys(molecule.atoms);
    var bonds = Object.keys(molecule.bonds);

    var nodes = [];
    var links = [];

    for (var i = 0; i < atoms.length; i++) {

        nodes.push({
            id: molecule.atoms[atoms[i]].id,
            name: molecule.atoms[atoms[i]].name,
            protons: molecule.atoms[atoms[i]].protons,
            neutrons: molecule.atoms[atoms[i]].neutrons,
            electrons: molecule.atoms[atoms[i]].electrons,
            bonds: molecule.atoms[atoms[i]].bonds,
            properties: molecule.atoms[atoms[i]].properties
        })
    }

    for (var i = 0; i < bonds.length; i++) {

        links.push({
            id: molecule.bonds[bonds[i]].id,
            name: molecule.bonds[bonds[i]].name,
            value: molecule.bonds[bonds[i]].value,
            source: atoms.indexOf(molecule.bonds[bonds[i]].atoms[0]),
            target: atoms.indexOf(molecule.bonds[bonds[i]].atoms[1]),
            order: molecule.bonds[bonds[i]].order
        })
    }

    return {nodes: nodes, links: links};
}


var mainPanel = d3.select("#svgDiv")
    .append("svg")
    .attr("preserveAspectRatio", "xMinYMin meet")
    .attr("id", "previewMoleculeSVG")




//
// Initialize d3.js
//
var forceProperties = {
    charge         : -1200,
    chargeDistance : 500,
    linkStrength   : 1.5,
    linkDistance   : -40,
    gravity        : 1.3,
    friction       : 0.65,
    alpha          : 2.0

}

var force = d3.layout.force()
    .charge(forceProperties.charge)
    .chargeDistance(forceProperties.chargeDistance)
    .linkStrength(forceProperties.linkStrength)
    .linkDistance(forceProperties.linkDistance)
    .gravity(forceProperties.gravity)
    .friction(forceProperties.friction)
    .alpha(forceProperties.alpha);

//
// Update d3.js
//
function update(molecule) {

    //
    // Molecule Properties
    //
    var graph = convertMolecule(molecule);
    var nodes = force.nodes(graph.nodes);
    var links = force.links(graph.links);

    d3.selectAll(".node").remove()
    d3.selectAll(".separator").remove()

    //
    // Bond Properties
    //
    var bondMuliplier = 3;

    var piBond = {
        stroke: '#FFFFFF',
        strokeWidth: '2px'
    };

    var aromaticBond = {
        stroke: '#696969',
        strokeWidth: '3px',
        strokeDashArray: ("3,3")
    };

    var bond = mainPanel.selectAll("line.link")
        .data(graph.links, function(d) { return d.source + "-" + d.target; } )
        .enter();

    var singleBond = bond.append("svg:line")
        .filter(function (d) { return d.order == 1 | d.order == 2 | d.order == 3 })
        .attr("class", "link")
        .style("stroke-width", function(d) { return (d.order * bondMuliplier - 1) * (bondMuliplier/2) + "px"; })

    var doubleBond = bond.append("svg:line")
        .filter(function (d) { return d.order == 2 })
        .attr("class", "separator")
        .style("stroke-width", piBond.strokeWidth)
        .style("stroke", piBond.stroke)

    var aromaticBond_1 = bond.append("svg:line")
        .filter(function (d) { return d.order == 1.5 })
        .attr("class", "separator")
        .style("stroke-width", aromaticBond.strokeWidth)
        .style("stroke", aromaticBond.stroke)

    var aromaticBond_2 = bond.append("svg:line")
        .filter(function (d) { return d.order == 1.5 })
        .attr("class", "link")
        .style("stroke-width", aromaticBond.strokeWidth)
        .style("stroke", aromaticBond.stroke)
        .style("stroke-dasharray", aromaticBond.strokeDashArray)

    var tripleBond_1 = bond.append("svg:line")
        .filter(function (d) { return d.order == 3 })
        .attr("class", "separator")
        .style("stroke-width", piBond.strokeWidth)
        .style("stroke", piBond.stroke)

    var tripleBond_2 = bond.append("svg:line")
        .filter(function (d) { return d.order == 3 })
        .attr("class", "separator")
        .style("stroke-width", piBond.strokeWidth)
        .style("stroke", piBond.stroke)

    mainPanel.selectAll("line.link")
        .data(graph.links, function(d) { return d.source + "-" + d.target; } )
        .exit().remove();

    //
    // Atom Properties
    //
    var maxProtons = 11;
    var maxRadius = 10;
    var minRadius = 2.7;
    var atomMultiplier = 2.8;

    var atom = mainPanel.selectAll("circle")
        .data(graph.nodes, function(d) { return Math.random(); });

    atom.enter()
        .append("circle")
        .attr("class", "node")
        .attr("class", function(d) { return 'atom-' + d.name; })
        .attr("r", function(d) { return (d.protons < maxProtons) ? (Math.sqrt(d.protons + minRadius) * atomMultiplier) : maxRadius; })
        .call(force.drag)


    atom.exit()
        .remove();

    //
    // XY Coordinates
    //
    var atomRadius = 9;
    var bondOffset = 2;

    force.start();

    force.on("tick", function () {

        singleBond
            .attr("x1", function(d) { return d.source.x; })
            .attr("y1", function(d) { return d.source.y; })
            .attr("x2", function(d) { return d.target.x; })
            .attr("y2", function(d) { return d.target.y; });

        doubleBond
            .attr("x1", function(d) { return d.source.x; })
            .attr("y1", function(d) { return d.source.y; })
            .attr("x2", function(d) { return d.target.x; })
            .attr("y2", function(d) { return d.target.y; });

        aromaticBond_1
            .attr("x1", function(d) { return d.source.x - xOffset(bondOffset, d.source, d.target) })
            .attr("y1", function(d) { return d.source.y - yOffset(bondOffset, d.source, d.target) })
            .attr("x2", function(d) { return d.target.x - xOffset(bondOffset, d.source, d.target) })
            .attr("y2", function(d) { return d.target.y - yOffset(bondOffset, d.source, d.target) });

        aromaticBond_2
            .attr("x1", function(d) { return d.source.x - xOffset(-bondOffset, d.source, d.target) })
            .attr("y1", function(d) { return d.source.y - yOffset(-bondOffset, d.source, d.target) })
            .attr("x2", function(d) { return d.target.x - xOffset(-bondOffset, d.source, d.target) })
            .attr("y2", function(d) { return d.target.y - yOffset(-bondOffset, d.source, d.target) });

        tripleBond_1
            .attr("x1", function(d) { return d.source.x - xOffset(bondOffset, d.source, d.target) })
            .attr("y1", function(d) { return d.source.y - yOffset(bondOffset, d.source, d.target) })
            .attr("x2", function(d) { return d.target.x - xOffset(bondOffset, d.source, d.target) })
            .attr("y2", function(d) { return d.target.y - yOffset(bondOffset, d.source, d.target) });

        tripleBond_2
            .attr("x1", function(d) { return d.source.x - xOffset(-bondOffset, d.source, d.target) })
            .attr("y1", function(d) { return d.source.y - yOffset(-bondOffset, d.source, d.target) })
            .attr("x2", function(d) { return d.target.x - xOffset(-bondOffset, d.source, d.target) })
            .attr("y2", function(d) { return d.target.y - yOffset(-bondOffset, d.source, d.target) });

        atom
            .attr("cx", function(d) { return d.x = Math.max(atomRadius, Math.min(PlotWidth - atomRadius, d.x)); })
            .attr("cy", function(d) { return d.y = Math.max(atomRadius, Math.min(PlotHeight - atomRadius, d.y)); });

    });

    // Update text
    if (typeof molecule === 'object') {
        updateMolecularWeight(molecule);
        updateMolecularFormula(molecule);
    }
    removeEmptyLines()

}

//
// Helper Functions
//
function removeEmptyLines()
{
   var smiles= smilesValue.value
     previewMoleculeSVG.setAttribute("smiles",smiles)


   for(var k=previewMoleculeSVG.childNodes.length-1;k>=0;k--)
   {
      var node=previewMoleculeSVG.childNodes.item(k)
      if(node.nodeName=="line"&& !node.getAttribute("class"))
        previewMoleculeSVG.removeChild(node)
   }
      parent.SMILES=smiles

}





function xOffset(offset, source, target) {
    var dx = target.x - source.x;
    var dy = target.y - source.y;
    if (dy === 0 || Math.abs(dx/dy) > 1) { return offset * (dy/dx); }
    else { return offset; }
}

function yOffset(offset, source, target) {
    var dx = target.x - source.x;
    var dy = target.y - source.y;
    if (dy === 0 || Math.abs(dx/dy) > 1) { return -offset; }
    else { return offset * -(dx/dy); }
}

//
// Text Functions
//
function getAtomText(atom) {

    var str = atom.name;
    var x = atom.properties.charge;
    var n = '';

    if (x !== 0) {

        if (x === 1) { n = '+'; }
        else if ( x > 1 ) { n = x + '+' }
        else if ( x === -1 ) { n = '-' }
        else if ( x < -1 ) { n = x + '-' }

        str = str.concat('<sup>' + n + '</sup>');
    }

    return str
}

function updateMolecularWeight(molecule) {

    var decimalPoints = Math.pow(10, 2);
    //var molecularWeight = (Math.round(molecule.properties.mass * decimalPoints) / decimalPoints) + ' g/mol';

    //document.getElementById("molecularWeight").innerHTML = molecularWeight;
}

function updateMolecularFormula(molecule) {

    var molecularFormula = [];
    var atoms = Object.keys(molecule.properties.formula).sort();

    var charge = 0;

    Object.keys(molecule.atoms).forEach(function (key) {
        charge += molecule.atoms[key].properties.charge;
    });

    function updateFormula(atomName) {
        var atomCount = molecule.properties.formula[atomName];

        if (atomCount === 1) { molecularFormula.push(atomName); }
        else { molecularFormula.push(atomName + atomCount); }

        atoms.splice(atoms.indexOf(atomName), 1);
    }

    if (atoms.indexOf('Li') !== -1) { updateFormula('Li'); }
    if (atoms.indexOf('Na') !== -1) { updateFormula('Na'); }
    if (atoms.indexOf('Mg') !== -1) { updateFormula('Mg'); }
    if (atoms.indexOf('K') !== -1)  { updateFormula('K'); }
    if (atoms.indexOf('Ca') !== -1) { updateFormula('Ca'); }

    if (atoms.indexOf('C') !== -1) { updateFormula('C'); }
    if (atoms.indexOf('H') !== -1) { updateFormula('H'); }

    while (atoms.length > 0) { updateFormula(atoms[0]); }

    molecularFormula = molecularFormula.join('').replace(/(\d+)/g, '<sub>$1</sub>');

    // Append molecule charge
    if (charge !== 0) {
        var n = '';

        if (charge === 1) { n = '+'; }
        else if ( charge > 1 ) { n = charge + '+' }
        else if ( charge === -1 ) { n = '-' }
        else if ( charge < -1 ) { n = charge + '-' }

        molecularFormula = molecularFormula.concat('<sup>' + n + '</sup>');
    }
        parent.MolecularFormula=molecularFormula
    molecularFormulaDiv.innerHTML ="Molecular Formula: "+ molecularFormula;

}

// Topology Functions
//
function getTopology(molecule) {

    var adjacency = Molecules.topology.matrix.adjacency(molecule);
    var distance = Molecules.topology.matrix.distance(adjacency);

    return {
        adjacent: adjacency,
        distance: distance
    };
}

function formatMatrix(input) {

    var output = [];

    for (var i = 0; i < input.length; i++) {
        output[i] = [];

        for (var j = 0; j < input[0].length; j++) {
            output[i][j] = { x: j, y: i, z: input[i][j] };
        }
    }

    return output;
 }

function updateMatrix(input) {

    var matrix = document.getElementById("matrix");
    var height =PlotHeight
    var width = PlotWidth
    var distance = formatMatrix(input.distance);

    support.append("rect")
        .attr("class", "background")
        .attr("width", width * 2)
        .attr("height", height)
        .attr("x", width*2);

    var x = d3.scale.ordinal().rangeBands([0, width*0.85]);
    var z = d3.scale.linear().domain([0, distance.length]).clamp(true);
    var c = d3.scale.linear().range(["red", "steelblue"]).interpolate(d3.interpolateHcl);

    c.domain(d3.range(distance.length));
    x.domain(d3.range(input.header.length));

    var row = support.selectAll(".row")
        .data(distance)
        .enter().append("g")
        .attr("class", "row")
        .attr("transform", function(d, i) { return "translate(" + (width * 0.1) + "," + (x(i) + height * 0.1) + ")"; })
        .each(row);

    row.append("line")
        .attr("x2", -width);

    row.append("text")
        .attr("x", (x.rangeBand() / 2) - (x.rangeBand()/1.5))
        .attr("y", x.rangeBand() / 2)
        .attr("dy", ".32em")
        .attr("text-anchor", "end")
        .text(function(d, i) { return input.header[i]; });

    var column = support.selectAll(".column")
        .data(distance)
        .enter().append("g")
        .attr("class", "column")
        .attr("transform", function(d, i) { return "translate(" + x(i) + ")rotate(0)"; });

    column.append("line")
        .attr("x1", -width);

    column.append("text")
        .attr("x", x.rangeBand())
        .attr("y", (x.rangeBand() / 1.5))
        .attr("dy", ".32em")
        .attr("text-anchor", "start")
        .text(function(d, i) { return input.header[i]; });

    function row(row) {

        var cell = d3.select(this).selectAll(".cell")
            .data(row.filter(function(d) { return d.z; }))
            .enter().append("rect")
            .attr("class", "cell")
            .attr("x", function(d) { return x(d.x); })
            .attr("width", x.rangeBand()*0.97)
            .attr("height", x.rangeBand()*0.97)
            .style("fill-opacity", function(d) { return z(d.z)+0.4; })
            .style("fill", function(d) { return c(d.z-1); });
    }
}

//


//
// SMILES Examples
//
var selectedMolecule = []
        selectedMolecule[0]=''  //---
selectedMolecule[1]='[N+](=O)([O-])C1=C(C)C(=CC(=C1)[N+](=O)[O-])[N+](=O)[O-]'   //--- 2,4,6-trinitrotoluene
selectedMolecule[2]='NC(C(=O)O)C'  //---  2-amino-propanoic-acid
selectedMolecule[3]='C(C)N(C(CCCCC)=O)CC'  //---  N,N-diethylhexanamide
selectedMolecule[4]='C(C)N(C(CC(C)C)=O)CCC'  //---  N-ethyl-N-propyl-3-methylbutanamide
selectedMolecule[5]='IC#CCl' //---   1-iodo-2-chloroethyne
selectedMolecule[6]='BrC(C(=O)O)(C(C#C)F)F' //---   2-bromo-2,3-difluoropent-4-ynoic-acid
selectedMolecule[7]='CC(C#CC(C)=O)C(CC)=O' //---   5-methyloct-3-yn-2,6-dione
selectedMolecule[8]='CC(CC=O)(C)I'  //--- 3-methyl-3-iodobutanal
selectedMolecule[9]='IC(CCN)(C(CC)N)C'  //---  3-iodo-3-methylhexan-1,4-diamine
selectedMolecule[10]='ClC(CC)C(C(CC)C)(CC)Cl'  //---  3,4-dichloro-4-ethyl-5-methylheptane
selectedMolecule[11]='ClC(CC)C(C(CC)C)(CC)Cl'  //---  3,4-dichloro-4-ethyl-5-methylheptane


function chemicalNameSelected()
{

  if(chemicalNameSelect.selectedIndex>0)
  {

     var chemicalName=chemicalNameSelect.options[chemicalNameSelect.selectedIndex].value
      chemicalNameValue.value=chemicalName
      smilesValue.value=selectedMolecule[chemicalNameSelect.selectedIndex]
      loadSmiles()
  }


}


</script>
<script>

function sendSize()
{

   var width=containerDiv.scrollWidth+30
   var height=containerDiv.scrollHeight+30


    parent.previewMoleculeFrame.style.width=width +"px"
    parent.previewMoleculeFrame.style.height=height +"px"


    parent.previewMoleculeFrameDiv.style.width=width +"px"
    parent.previewMoleculeFrameDiv.style.height=height +"px"

}

</script>